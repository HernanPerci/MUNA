---
title: "Informe del proyecto Museo Nacional (MUNA)"
author: "Hernan Perci Nuñez Palomino"
date: "Última edición `r format(Sys.time(), '%d %B %Y')`"
output: 
    word_document:
      reference_docx: "template.docx"
---

\listoffigures
\listoftables

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

El Museo Nacional del Perú – MUNA [Pagina Web](https://muna.cultura.pe/) es una de las obras más emblemáticas del Estado Peruano realizada por el Ministerio de Cultura.

![](002_MNP_Explanada_1.jpg)

# Finalidad del estudio

Se busca tener una perspectiva más amplia de las apreciaciones y expectativas por parte del público objetivo queriendo llegar a tener una reflexión objetiva de acuerdo a las respuestas de las preguntas seleccionadas, las cuales nos ayudara a direccionar las estrategias de comunicación para el museo.

# Paquetes usados en el desarrollo del informe

Son paquetes de funciones desarrolladas por otros autores para el rápido manejo de los análisis.

```{r librerias}

library(readxl)
library(tidyverse)
library(knitr)
library(skimr)
library(naniar)
library(VIM)
library(ggthemes)
```


# Estructura de la información recopilada

Se recopila la información de las diversas fuentes y se genera un marco único de trabajo.

```{r SUR}

SUR <- read_excel("Base de datos SUR.xlsx") # accedemos al excel
SUR <- SUR[2:nrow(SUR),] # elejimos la data
colnames(SUR) <- c(paste(replicate(n = 205, "Var_"), 1:205, sep = "")) # le asignamos nombres previos a las columnas

```


```{r DEMAS}

# de igual manera que con la data SUR
DEMAS <- read_excel("base de datos lima excepto sur 16_08.xlsx")
DEMAS <- DEMAS[2:nrow(DEMAS),]
colnames(DEMAS) <- c(paste(replicate(n = 205, "Var_"), 1:205, sep = ""))

```

La data `MUNA` contiene la información recopilada en las encuestas.

```{r MUNA}

MUNA <- bind_rows(SUR, DEMAS) # juntamos la información recopilada
glimpse(MUNA) # vista previa de las variables

```

Los tipos de variables se iran cambiando de acuerdo vayamos avanzando en el informe.

# Resumenes iniciales

Pertenecen aca las variables creadas por el surveymonkey al usar la encuesta.

## ID

```{r}

MUNA$Var_1 <- factor(MUNA$Var_1) 

Tabla1 <- MUNA %>%  
  count(Var_1) %>%
  summarise(min = min(n),max = max(n))

  kable(Tabla1, col.names = c("Mínimo", "Máximo"),
        align = "ccc",
        caption = "Tabla 1: Numero mínimo y maximo de ID")

```

Observamos que los identificadores no se repiten ya que cada ID le corresponde solo a un encuestador.

## Aplicador

```{r}

MUNA$Var_3 <- factor(MUNA$Var_3)

Tabla2 <- MUNA %>%
  count(Var_3, sort = TRUE) %>%
  mutate(porcentage = paste0(sprintf("%4.1f", n / sum(n) * 100), "%"), 
         Var_3 = str_remove(Var_3, ".*_"), 
         Var_3 = str_to_title(Var_3))

kable(Tabla2, col.names = c("Encuestador", "N° de Encuestas", "% de Encuestas"),
        align = "ccc",
        caption = "Tabla 2: Resumen del total de encuestas procesadas por encuestador")

```


```{r, fig.width= 10, fig.height= 8}

Tabla2 %>% 
    mutate(Var_3 = fct_inorder(Var_3), 
         Var_3 = fct_rev(Var_3)) %>%
  ggplot(mapping = aes(x = Var_3, y = n)) +
  geom_col() +
  geom_label(mapping = aes(label = porcentage), hjust = 1.1) +
  labs(x = "Encuestadores", y = "Encuestas recopiladas", title = "Cantidad de encuestas recopiladas por encuestador", subtitle = "Barras(en unid), etiquetas(en %)", caption = "Elaboración propia") +
  coord_flip() +
  theme_solarized()

```

* El encuestador que aplicó más encuestas fue `r Tabla2$Var_3[1]` con `r Tabla2$n[1]` encuestas recopiladas que representa el `r Tabla2$porcentage[1]` del total.

* El encuestador que aplicó menos encuestas fue `r Tabla2$Var_3[nrow(Tabla2)]` con `r Tabla2$n[nrow(Tabla2)]` encuestas recopiladas que representa el `r Tabla2$porcentage[nrow(Tabla2)]` del total.

## Tiempo de recolección

Se describira la hora que se recogió la encuesta, la hora que se finalizó y el tiempo en el que se demoran en terminar una encuesta.

```{r}

MUNA$Var_4 <- as.POSIXct(MUNA$Var_4)
MUNA$Var_5 <- as.POSIXct(MUNA$Var_5)

Tabla3 <- MUNA %>%
  select(Var_4, Var_5) %>%
  mutate(Dif = difftime(Var_5, Var_4, units = "mins"),
         Dif = round(Dif, digits = 1)) %>%
  arrange(desc(Dif))

kable(rbind(head(Tabla3), tail(Tabla3)), col.names = c("Inicio de la encuesta", "Final de la encuesta", "Tiempo transcurrido"),
        align = "ccc",
        caption = "Tabla 3: Resumen del tiempo de inicio, final y de demora para aplicar la encuesta (6 mas rapidos y 6 mas lentos)")

```


```{r}

ggplot(Tabla3, mapping = aes(x = Var_4, y = Dif)) + 
  geom_point(color = "blue") +
  geom_point(mapping = aes(x = Var_5), color = "red") +
  geom_segment(mapping = aes(x = Var_4, xend = Var_5, y = Dif, yend = Dif)) +
  geom_label(data = head(Tabla3, 1), mapping = aes(label = Dif), vjust = -0.1) +
  geom_label(data = tail(Tabla3, 1), mapping = aes(label = Dif), vjust = -0.1) +
  geom_hline(yintercept = median(Tabla3$Dif), color = "green") +
  annotate("text", x = as.POSIXct("2021-08-15"), y = median(Tabla3$Dif) + 3, label = median(Tabla3$Dif), color = "green") +
  labs(x = "Dia y Hora", y = "Tiempo de demora", title = "Inicio y fin de la encuesta", subtitle = "Segmentos que comprenden la duracion de la encuesta", caption = "elaboracion propia") +
  theme_solarized()

```

* El tiempo máximo de demora en la encuesta es de `r max(Tabla3$Dif)`.
* El tiempo medio de demora en la encuesta es de `r median(Tabla3$Dif)`.
* El tiempo mínimo de demora en la encuesta es de `r min(Tabla3$Dif)`.

# Preguntas de filtro
Son las preguntas que se le debe de hacer para proseguir con la encuesta. Se de be tener puras afirmativas

## ¿Usted tiene hijos y/o hijas en edad escolar (6 a 17 años)?



